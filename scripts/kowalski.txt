NetInsight analysis layer — ne yapıyor, ne çıkarıyor?
1) Log inspection (scripts/inspect_log.py)

Amaç: Ham logun “sağlıklı mı” hızlı kontrolü.
Ne hesaplıyor / gösteriyor:

Kaç satır var, hangi kolonlar var

Probe type bazında success rate (ping/dns/http)

Service + probe bazında ortalama latency ve success rate

Error kind/message dağılımları (en çok hangi hata var)
Çıktı: Terminal summary (debug / sanity-check için)

2) Hourly stats (scripts/analyze_time_of_day.py)

Amaç: Günün hangi saatlerinde ağ daha iyi/kötü?
Ne hesaplıyor:

Saatlik ortalama ping latency (avg_latency_ms)

Saatlik packet loss (packet_loss_pct)

Saatlik probe sayısı

En iyi / en kötü saatler
Çıktı:

data/hourly_stats.csv (0–23 saat bazlı özet)

3) Downtime detection (scripts/detect_downtime.py)

Amaç: “Gerçek kesinti” event’lerini yakalamak (sadece yavaşlık değil).
Kural:

Aynı servis için ≥3 ardışık ping fail

Fail’ler arası boşluk ≤90 saniye ise aynı event sayılıyor
Ne çıkarıyor:

Event-level downtime: start/end/duration/fail count

Servis bazında toplam downtime ve event sayısı
Çıktı:

data/downtimes.csv (tek tek downtime eventleri)

data/total_downtime.csv (servis başına toplam süre + kaç event)

4) Quality scoring (scripts/quality_score.py) ✅ ana analiz katmanı

Amaç: Ham metrikleri “yorumlanabilir tek skora” çevirip kıyaslamak.
Nasıl:

Her ölçüm satırı için 0–100 quality score

Probe type’a göre farklı scoring:

ping: latency + jitter + packet loss → exponential decay

dns: dns time → exponential decay

http: http time → exponential decay + status code penalty

Score → tier:

good ≥ 80, ok ≥ 50, bad < 50

Ek olarak: score_z = (score - global_mean) / global_std
→ “bu ölçüm kendi dataset baseline’ına göre kaç std iyi/kötü?”
Çıktı:

data/quality_rows.csv (row-level: score, tier, score_z)

data/quality_hourly.csv (hourly: avg, p10/p90, good/bad %, score_z_avg)

data/quality_by_service.csv (servis ranking: avg score + good/bad % + score_z_avg)

5) Bad interval detection + attribution (scripts/detect_bad_intervals.py) ✅ “akıllı kısım”

Amaç: Sadece “saat kötü” demek değil, hangi zaman aralığında problem varı otomatik yakalamak.
Yöntem:

5 dakikalık rolling window (1 dk step ile sample)

Her window için:

mean_score

bad_pct (bad tier yüzdesi)

Dataset baseline: window’ların global mean/std’si

Window z-score:

window_score_z = (mean_score - global_mean) / global_std

negatif = daha kötü

Bad window flag:

window_score_z <= -1.0 veya bad_pct >= 50%

Ardışık bad window’lar birleşiyor → interval
Interval çıktıları:

mean_score_delta = mean_score - global_mean (kaç puan düştü)

mean_score_z = standardized düşüş (örn -2.9 = çok güçlü anomali)

severity (1/2/3): z-score ve bad% eşiklerine göre

service attribution:

kaç servis etkilenmiş (affected_services_count)

en kötü servisler (top_services_by_bad_pct)

diagnosis:

gateway involved mı?

affected_services_count yüksekse network_wide (genel ağ problemi)
Çıktı:

data/bad_intervals.csv (problemli zaman aralıkları + sebepleri)